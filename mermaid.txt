---
config:
  theme: neo
  look: classic
  layout: fixed
---
flowchart TD
 subgraph Memory["💾 Memory & State"]
        ADKSession["ADK Session Context<br>- Conversation History<br>- Agent Transfer State<br>- Shared Memory"]
        OutputKeys["Structured Output Keys<br>- identified_weaknesses<br>- extracted_data<br>- research_findings<br>- implementation_plan<br>- formatted_report"]
  end
 subgraph Tools["🛠️ Agent Tools"]
        RAGTool["rag_retrieval_grounding<br>📋 Student Data Retrieval<br>(VertexAiRagRetrieval)"]
        GoogleSearch["google_search<br>🔍 Web Research Tool<br>(Educational Resources)"]
        TransferTool["transfer_to_agent<br>🔄 Agent Orchestration<br>(ADK Built-in)"]
  end
 subgraph AIMLServices["🧠 AI/ML Services"]
        VertexAI["Vertex AI Platform"]
        GeminiFlash["Gemini 2.0 Flash<br>- Function Calling<br>- Reasoning<br>- Context Preservation"]
        EmbeddingModel["text-embedding-005<br>- Semantic Understanding<br>- 512 Token Chunks"]
  end
    User["👤 User<br>(Educator)"] -- interacts --> StreamlitUI["🎨 Streamlit Dashboard<br>- Document Upload<br>- Corpus Management<br>- Analytics"]
    User -- chats via --> ADKUI["🤖 ADK Chat Interface<br>- Agent Interaction<br>- Session Management<br>- Real-time Chat"]
    StreamlitUI -- uploads --> ReportCards["📄 Report Card Documents<br>(PDF, DOCX, TXT)"]
    ReportCards --> CloudStorage["☁️ Google Cloud Storage<br>- Document Repository<br>- Knowledge Base"]
    CloudStorage --> RAGCorpus["🗂️ Vertex AI RAG Corpus<br>- Vector Embeddings<br>- Similarity Threshold: 0.7"]
    RAGCorpus --> EmbeddingModel
    EmbeddingModel --> VectorIndex["📊 Vector Search Index<br>- 768 Dimensions<br>- Cosine Similarity<br>- Top-K: 5"]
    VectorIndex --> RAGTool
    StreamlitUI --> VisualizationDashboard["📊 Analytics Dashboard<br>- Performance Metrics<br>- Trend Analysis<br>- Progress Tracking"]
    
    %% AI/ML Service Connections
    VertexAI --> GeminiFlash
    VertexAI --> RAGCorpus
    VertexAI --> EmbeddingModel
    VertexAI --> GoogleSearch
    
    %% Multi-Agent System
    ADKUI --> RootAgent["🎯 Root Agent<br>- Query Analysis<br>- Workflow Orchestration<br>- Context Management"]
    RootAgent --> TransferTool
    
    %% Agent Transfer Relationships
    TransferTool --> WeaknessAnalyzer["🔍 Weakness Analyzer<br>- Performance Gap Analysis<br>- Grade Pattern Recognition<br>- Severity Classification"]
    TransferTool --> DataRetriever["📊 Data Retriever<br>- Precise Data Extraction<br>- Cross-Reference Validation<br>- Evidence Attribution"]
    TransferTool --> SolutionResearcher["🔬 Solution Researcher<br>- Evidence-Based Interventions<br>- Current Research Findings<br>- Strategy Identification"]
    TransferTool --> StudyPlanner["📅 Study Planner<br>- Implementation Timelines<br>- Resource Allocation<br>- Milestone Setting"]
    TransferTool --> PresentationFormatter["📝 Presentation Formatter<br>- Report Synthesis<br>- Professional Formatting<br>- Stakeholder Content"]
    
    %% Agent Tool Usage (Specific Relationships)
    WeaknessAnalyzer --> RAGTool
    DataRetriever --> RAGTool
    SolutionResearcher --> GoogleSearch
    
    %% Tool to Service Connections
    RAGTool --> RAGCorpus
    GoogleSearch --> VertexAI
    
    %% Agent Workflow Sequence
    WeaknessAnalyzer --> DataRetriever
    DataRetriever --> SolutionResearcher
    SolutionResearcher --> StudyPlanner
    StudyPlanner --> PresentationFormatter
    
    %% Session & State Management
    RootAgent --> ADKSession
    WeaknessAnalyzer --> ADKSession
    DataRetriever --> ADKSession
    SolutionResearcher --> ADKSession
    StudyPlanner --> ADKSession
    PresentationFormatter --> ADKSession
    ADKSession --> OutputKeys
    
    %% Output Generation
    PresentationFormatter --> FinalReport["📋 Comprehensive Analysis Report<br>- Executive Summary<br>- Evidence-Based Recommendations<br>- Implementation Strategies"]
    FinalReport --> Download["📥 Downloadable Report"]
    Download --> User
    OutputKeys --> VisualizationDashboard
    VisualizationDashboard --> User
    
    %% External Integrations
    GoogleSearch -.-> ExternalWeb["🌐 External Web Resources<br>- Educational Research<br>- Intervention Strategies<br>- Best Practices"]
    ExternalWeb -.-> SolutionResearcher
    
    %% Apply CSS Classes to Elements
    ADKSession:::memory
    OutputKeys:::memory
    RAGTool:::ragTool
    GoogleSearch:::searchTool
    TransferTool:::transferTool
    VertexAI:::aiService
    GeminiFlash:::aiService
    EmbeddingModel:::aiService
    User:::user
    StreamlitUI:::user
    ADKUI:::user
    ReportCards:::user
    CloudStorage:::storage
    RAGCorpus:::storage
    VectorIndex:::storage
    VisualizationDashboard:::output
    RootAgent:::rootAgent
    WeaknessAnalyzer:::weaknessAgent
    DataRetriever:::dataAgent
    SolutionResearcher:::researchAgent
    StudyPlanner:::planAgent
    PresentationFormatter:::formatAgent
    FinalReport:::output
    Download:::output
    ExternalWeb:::external
    
    %% CSS Class Definitions
    classDef user fill:#fef3c7,stroke:#facc15,color:#000,stroke-width:2px
    classDef storage fill:#dcfce7,stroke:#22c55e,color:#000,stroke-width:2px
    classDef aiService fill:#dbeafe,stroke:#3b82f6,color:#000,stroke-width:2px
    classDef ragTool fill:#fed7d7,stroke:#f87171,color:#000,stroke-width:2px
    classDef searchTool fill:#bae6fd,stroke:#0ea5e9,color:#000,stroke-width:2px
    classDef transferTool fill:#e0f2fe,stroke:#06b6d4,color:#000,stroke-width:2px
    classDef rootAgent fill:#fce7f3,stroke:#ec4899,color:#000,stroke-width:3px
    classDef weaknessAgent fill:#fca5a5,stroke:#ef4444,color:#000,stroke-width:2px
    classDef dataAgent fill:#fdba74,stroke:#f97316,color:#000,stroke-width:2px
    classDef researchAgent fill:#bae6fd,stroke:#0ea5e9,color:#000,stroke-width:2px
    classDef planAgent fill:#bbf7d0,stroke:#22c55e,color:#000,stroke-width:2px
    classDef formatAgent fill:#ddd6fe,stroke:#8b5cf6,color:#000,stroke-width:2px
    classDef memory fill:#fed7d7,stroke:#f56565,color:#000,stroke-width:2px
    classDef output fill:#e0f2fe,stroke:#38bdf8,color:#000,stroke-width:2px
    classDef external fill:#f3f4f6,stroke:#9ca3af,color:#000,stroke-width:1px,stroke-dasharray: 5 5
